<?php//Add request dataadd_action('wp_ajax_beau_ApiSubcribe', 'beau_storeAddress');add_action('wp_ajax_nopriv_beau_ApiSubcribe', 'beau_storeAddress');function beau_storeAddress(){    global $beau_option;    if (isset($beau_option['mailchimp-api'])) {        $api_value  = $beau_option['mailchimp-api'];    }else{        $api_value  = "";    }    if (isset($beau_option['mailchimp-api'])) {        $list_id    = $beau_option['mailchimp-groupid'];    }else{        $list_id ="";    }    $msg_json = array();	// Validation	if(!$_GET['email']){ 		$msg_json = array(			'type'	=>	'error',			'txt'	=>	esc_html__("No email address provided",'citysoul')			);		//return esc_html__("No email address provided",'citysoul');		return json_encode($msg_json);	 }	if(!preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*$/i", $_GET['email'])) {		$msg_json = array(			'type'	=>	'error',			'txt'	=>	esc_html__("Email address is invalid",'citysoul')			);		return json_encode($msg_json);        exit();	}	require_once(BEAU_PLUGIN_DIR.'/libs/MailChimp/MCAPI.class.php');	// grab an API Key from http://admin.mailchimp.com/account/api/	$api = new MCAPI($api_value);	// grab your List's Unique Id by going to http://admin.mailchimp.com/lists/	// Click the "settings" link for the list - the Unique Id is at the bottom of that page.	//$list_id = "my_list_unique_id";	if($api->listSubscribe($list_id, $_GET['email'], '') === true) {		// It worked!		$msg_json = array(			'type'	=>	'success',			'txt'	=>	esc_html__("Success! Check your email to confirm sign up.",'citysoul')			);		return json_encode($msg_json);        exit();	}else{		// An error ocurred, return error message		$msg_json = array(			'type'	=>	'error',			'txt'	=>	esc_html__("Error : ",'citysoul'). $api->errorMessage			);		return json_encode($msg_json);        exit();	}    exit();}// If being called via ajax, autorun the functionif(isset($_GET['mailchimp-ajax'])){ echo beau_storeAddress(); exit();}?>